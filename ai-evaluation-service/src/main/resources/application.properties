# Application Configuration
quarkus.application.name=ai-evaluation-service

# Database Configuration
quarkus.datasource.db-kind=postgresql
%dev.quarkus.datasource.devservices.enabled=true
%test.quarkus.datasource.devservices.enabled=true
%prod.quarkus.datasource.username=${QUARKUS_DATASOURCE_USERNAME}
%prod.quarkus.datasource.password=${QUARKUS_DATASOURCE_PASSWORD}
%prod.quarkus.datasource.jdbc.url=${QUARKUS_DATASOURCE_JDBC_URL}

# Hibernate Configuration
quarkus.hibernate-orm.database.generation=drop-and-create
%prod.quarkus.hibernate-orm.database.generation=none

# Kafka Configuration
quarkus.kafka.devservices.enabled=true
%test.quarkus.kafka.devservices.enabled=true

# Kafka Consumer Configuration for Thought Events
mp.messaging.incoming.thoughts-events.topic=thoughts.events
mp.messaging.incoming.thoughts-events.value.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.incoming.thoughts-events.connector=smallrye-kafka
mp.messaging.incoming.thoughts-events.group.id=ai-evaluation-service
mp.messaging.incoming.thoughts-events.auto.offset.reset=earliest
mp.messaging.incoming.thoughts-events.enable.auto.commit=true
mp.messaging.incoming.thoughts-events.max.poll.records=100
mp.messaging.incoming.thoughts-events.fetch.max.wait.ms=500
mp.messaging.incoming.thoughts-events.session.timeout.ms=30000
mp.messaging.incoming.thoughts-events.heartbeat.interval.ms=3000

# Production Kafka Configuration
%prod.kafka.bootstrap.servers=${KAFKA_BOOTSTRAP_SERVERS}
%prod.mp.messaging.incoming.thoughts-events.topic=${KAFKA_THOUGHTS_TOPIC:thoughts.events}

# AI Evaluation Configuration
# Similarity threshold for vector comparison (cosine similarity: 0.0-1.0)
# Default: 0.85 - thoughts with similarity above this threshold to negative vectors are marked REJECTED
evaluation.similarity.threshold=0.85
%prod.evaluation.similarity.threshold=${EVALUATION_SIMILARITY_THRESHOLD:0.85}

# Langchain4j OpenShift AI Configuration
# OpenAI-compatible endpoint configuration for embedding model
quarkus.langchain4j.openai.base-url=${OPENSHIFT_AI_ENDPOINT_URL:http://localhost:8080}
quarkus.langchain4j.openai.api-key=${OPENSHIFT_AI_API_KEY:dummy-key}
quarkus.langchain4j.openai.embedding-model.model-name=${EMBEDDING_MODEL_NAME:text-embedding-ada-002}
quarkus.langchain4j.openai.timeout=30s
quarkus.langchain4j.openai.log-requests=true
quarkus.langchain4j.openai.log-responses=true
%dev.quarkus.langchain4j.openai.base-url=http://localhost:8080
%dev.quarkus.langchain4j.openai.api-key=dev-key
%test.quarkus.langchain4j.openai.base-url=http://localhost:8080
%test.quarkus.langchain4j.openai.api-key=test-key

# Logging Configuration
quarkus.log.console.json=true
%dev.quarkus.log.console.json=false
%test.quarkus.log.console.json=false
quarkus.log.category."com.redhat.demos.evaluation".level=DEBUG
%prod.quarkus.log.category."com.redhat.demos.evaluation".level=INFO

# Kubernetes/OpenShift Configuration
quarkus.kubernetes.deployment-target=openshift
quarkus.openshift.labels."app.kubernetes.io/name"=ai-evaluation-service
quarkus.openshift.labels."app.kubernetes.io/version"=1.0.0
quarkus.openshift.labels."app.openshift.io/runtime"=quarkus

# Resource Limits
quarkus.openshift.resources.requests.memory=256Mi
quarkus.openshift.resources.requests.cpu=250m
quarkus.openshift.resources.limits.memory=512Mi
quarkus.openshift.resources.limits.cpu=500m

# Health Checks
quarkus.openshift.liveness-probe.http-action-path=/q/health/live
quarkus.openshift.liveness-probe.initial-delay=30s
quarkus.openshift.liveness-probe.period=10s

quarkus.openshift.readiness-probe.http-action-path=/q/health/ready
quarkus.openshift.readiness-probe.initial-delay=10s
quarkus.openshift.readiness-probe.period=5s

# Container Image
quarkus.container-image.build=true
quarkus.container-image.group=redhat-demos
quarkus.container-image.name=ai-evaluation-service
quarkus.container-image.tag=latest

# CORS Configuration
quarkus.http.cors=false
%dev.quarkus.http.cors=true
%dev.quarkus.http.cors.origins=http://localhost:3000,http://localhost:3001,http://localhost:3002,http://localhost:8080
%dev.quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
%dev.quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
%dev.quarkus.http.cors.access-control-max-age=24H

# SmallRye Fault Tolerance - Retry Configuration
# Retry settings for LLM embedding generation
fault-tolerance.retry.max-retries=2
fault-tolerance.retry.delay=1000
fault-tolerance.retry.max-duration=10000
fault-tolerance.retry.jitter=200
